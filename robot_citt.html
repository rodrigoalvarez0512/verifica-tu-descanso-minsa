<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plantilla CITT (Robot)</title>
    <style>
        /* === CSS CORREGIDO v4 (FOOTER AJUSTADO) === */
        body {
            font-family: Arial, Helvetica, sans-serif;
            background-color: #ffffff; 
            margin: 0;
            padding: 0;
        }

        #citt-container {
            width: 794px;
            height: 1123px; /* Alto FIJO de A4 */
            background-color: #ffffff;
            /* border: 1px solid #000000; */ /* Borde quitado */
            position: relative;
            box-sizing: border-box;
            padding: 40px 60px;
        }
        /* === FIN DE CORRECCIONES === */

        .data {
            font-family: 'Courier New', Courier, monospace;
            font-size: 13px;
            font-weight: 700;
            color: #000;
            position: absolute;
            white-space: nowrap;
            line-height: 1.2;
            z-index: 2;
        }
        .label {
            font-size: 12px;
            color: #333;
            font-weight: 400;
            position: absolute;
            white-space: nowrap;
            line-height: 1.2;
            z-index: 2;
        }
        .subsection-title {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 1px;
            position: absolute;
            text-align: left;
            line-height: 1.2;
            z-index: 2;
        }
        .separator-line {
            position: absolute;
            left: 60px;
            width: calc(100% - 120px);
            height: 2px;
            background-color: #000;
            z-index: 2;
        }
        #citt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: absolute;
            top: 40px;
            left: 60px;
            width: calc(100% - 120px);
            z-index: 2;
        }
        #form-id { position: static; font-weight: 700; }
        #user-id { position: static; font-weight: 700; }
        #main-title {
            position: absolute;
            top: 90px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            width: 80%;
            z-index: 2;
        }
        .label-eess { top: 140px; left: 60px; }
        #data-eess { top: 140px; left: 190px; }
        .label-citt { top: 175px; left: 60px; }
        #data-citt { top: 175px; left: 190px; font-size: 22px; font-weight: 900; transform: translateY(-3px); }
        .label-acto { top: 215px; left: 60px; }
        #data-acto-medico { top: 215px; left: 190px; }
        .label-servicio { top: 240px; left: 60px; }
        #data-servicio { top: 240px; left: 190px; }
        #linea-separadora-1 { top: 270px; }
        .label-asegurado { top: 290px; left: 60px; }
        #data-paciente-nombre { top: 290px; left: 190px; }
        .label-doc { top: 315px; left: 60px; }
        #label-dni-sub { top: 315px; left: 190px; font-family: Arial, Helvetica, sans-serif; font-size: 12px; font-weight: 400; }
        #data-paciente-dni { top: 315px; left: 260px; }
        .label-autogen { top: 340px; left: 60px; }
        #data-autogenerado { top: 340px; left: 190px; }
        .label-atencion { top: 380px; left: 60px; }
        #data-tipo-atencion { top: 380px; left: 190px; }
        .label-contingencia { top: 405px; left: 60px; }
        #data-contingencia { top: 405px; left: 190px; }
        #linea-separadora-2 { top: 435px; }
        #title-periodo { top: 460px; left: 60px; }
        .label-f-inicio { top: 490px; left: 60px; }
        #data-fecha-inicio { top: 490px; left: 190px; }
        .label-f-fin { top: 515px; left: 60px; }
        #data-fecha-fin { top: 515px; left: 190px; }
        .label-total-dias { top: 540px; left: 60px; }
        #data-total-dias { top: 540px; left: 190px; }
        .label-f-otorga { top: 565px; left: 60px; }
        #data-fecha-otorgamiento { top: 565px; left: 190px; }
        #linea-separadora-3 { top: 595px; }
        #title-acumulados { top: 620px; left: 60px; }
        .label-consec { top: 650px; left: 60px; }
        #data-dias-consecutivos { top: 650px; left: 190px; }
        .label-no-consec { top: 675px; left: 60px; }
        #data-dias-no-consecutivos { top: 675px; left: 190px; }
        .label-tratante { top: 700px; left: 60px; }
        #data-medico-info { top: 700px; left: 190px; }
        .label-cmp { top: 725px; left: 60px; }
        #data-medico-cmp { top: 725px; left: 190px; }
        .label-rne { top: 750px; left: 60px; }
        #data-medico-rne { top: 750px; left: 190px; }
        .label-ruc { top: 775px; left: 60px; }
        #data-ruc { top: 775px; left: 190px; }
        #linea-separadora-4 { top: 805px; }
        .label-obs { top: 830px; left: 60px; font-weight: 700; }
        .label-dias-acum { top: 855px; left: 60px; }
        #data-dias-acumulados { top: 855px; left: 320px; }
        #linea-separadora-5 { top: 885px; }

        /* --- ARREGLO DE POSICIÓN DE FOOTER --- */
        .label-usuario { top: 900px; left: 60px; } 
        #data-usuario-registro { top: 900px; left: 120px; font-size: 11px; } 

         .signature-box { 
            position: absolute; 
            width: 200px; 
            height: 150px; 
            display: grid; 
            place-items: center; 
            font-size: 14px; 
            color: #aaa; 
            z-index: 1; 
            bottom: 60px; /* <-- MÁS ABAJO */
        }
        #sello-final { left: 100px; }
        #firma-final { right: 100px; }

        .label-fecha-reg { bottom: 30px; left: 60px; top: auto; } /* <-- MÁS ABAJO */
        #data-fecha-registro { bottom: 30px; left: 110px; top: auto; } /* <-- MÁS ABAJO */
        .label-hora-reg { bottom: 30px; right: 150px; top: auto; } /* <-- MÁS ABAJO */
        #data-hora-registro { bottom: 30px; right: 60px; top: auto; } /* <-- MÁS ABAJO */
        /* --- FIN DE ARREGLO --- */

        #qr-code-container { position: absolute; top: 140px; right: 60px; width: 100px; height: 100px; z-index: 2; }
        #qr-code-container img { display: block; width: 100%; height: 100%; }
    
    </style>
</head>
<body>

    <div id="citt-container">
        
        <div id="citt-header">
            <span class="label" id="form-id">Formulario 8017-1</span>
            <span class="label" id="user-id">USUARIO</span>
        </div>
        <h1 id="main-title">CERTIFICADO DE INCAPACIDAD TEMPORAL PARA EL TRABAJO</h1>
        <span class="label label-eess" id="label-entidad">EE.SS:</span>
        <span class="data" id="data-eess"></span>
        <span class="label label-citt">No. CITT:</span>
        <span class="data" id="data-citt"></span>
        <span class="label label-acto">Acto médico:</span>
        <span class="data" id="data-acto-medico"></span>
        <span class="label label-servicio">Servicio:</span>
        <span class="data" id="data-servicio"></span>
        <div id="qr-code-container"></div>
        <div class="separator-line" id="linea-separadora-1"></div>
        <span class="label label-asegurado">Nombre Asegurado:</span>
        <span class="data" id="data-paciente-nombre"></span>
        <span class="label label-doc">Doc. de Identidad:</span>
        <span class="label" id="label-dni-sub">DNI/C. E</span>
        <span class="data" id="data-paciente-dni"></span>
        <span class="label label-autogen">Autogenerado:</span>
        <span class="data" id="data-autogenerado"></span>
        <span class="label label-atencion">Tipo de Atención:</span>
        <span class="data" id="data-tipo-atencion"></span>
        <span class="label label-contingencia">Contingencia:</span>
        <span class="data" id="data-contingencia"></span>
        <div class="separator-line" id="linea-separadora-2"></div>
        <span class="subsection-title" id="title-periodo">PERIODO INCAPACIDAD</span>
        <span class="label label-f-inicio">Fecha de Inicio:</span>
        <span class="data" id="data-fecha-inicio"></span>
        <span class="label label-f-fin">Fecha Fin:</span>
        <span class="data" id="data-fecha-fin"></span>
        <span class="label label-total-dias">Total de Días:</span>
        <span class="data" id="data-total-dias"></span>
        <span class="label label-f-otorga">F. de Otorgamiento:</span>
        <span class="data" id="data-fecha-otorgamiento"></span>
        <div class="separator-line" id="linea-separadora-3"></div>
        <span class="subsection-title" id="title-acumulados">DIAS ACUMULADOS</span>
        <span class="label label-consec">Consecutivos:</span>
        <span class="data" id="data-dias-consecutivos"></span>
        <span class="label label-no-consec">No Consecutivos:</span>
        <span class="data" id="data-dias-no-consecutivos"></span>
        <span class="label label-tratante">PP.SS. Tratante:</span>
        <span class="data" id="data-medico-info"></span>
        <span class="label label-cmp">CMP:</span>
        <span class="data" id="data-medico-cmp"></span>
        <span class="label label-rne">RNE:</span>
        <span class="data" id="data-medico-rne"></span>
        <span class="label label-ruc">RUC:</span>
        <span class="data" id="data-ruc"></span>
        <div class="separator-line" id="linea-separadora-4"></div>
        <span class="label label-obs">OBSERVACIONES:</span>
        <span class="label label-dias-acum">Días de Incapacidad Temporal Acumulados:</span>
        <span class="data" id="data-dias-acumulados"></span>
        <div class="separator-line" id="linea-separadora-5"></div>
        <span class="label label-usuario">Usuario:</span>
        <span class="data" id="data-usuario-registro"></span>
        <span class="label label-fecha-reg">Fecha:</span> <span class="data" id="data-fecha-registro"></span>
        <span class="label label-hora-reg">Hora:</span> <span class="data" id="data-hora-registro"></span>
        <div class="signature-box" id="sello-final">
            <img src="sello.png" alt="Sello" style="max-width: 80%; max-height: 80%; object-fit: contain;">
        </div>
        <div class="signature-box" id="firma-final">
            <img src="firma.png" alt="Firma" style="max-width: 100%; max-height: 100%; object-fit: contain;">
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabaseClient.js"></script>
    <script src="robot_citt.js"></script>

</body>
</html>
